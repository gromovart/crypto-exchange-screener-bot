// internal/delivery/telegram/info_handlers.go
package telegram

import (
	"fmt"
	"log"
)

// SendSettingsInfo –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö (–≤–µ—Ä—Å–∏—è —Å userID)
func (mh *MenuHandlers) SendSettingsInfo(chatID string, userID int) error {
	// –ï—Å–ª–∏ –µ—Å—Ç—å —Å–µ—Ä–≤–∏—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ–ª—É—á–∞–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
	if mh.hasUserServices() && userID > 0 {
		settings, err := mh.settingsManager.GetUserSettingsTelegram(userID)
		if err == nil {
			message := "‚öôÔ∏è *–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏*\n\n" + settings + "\n\n" +
				"–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏–∑ –º–µ–Ω—é –Ω–∏–∂–µ:\n\n" +
				"‚Ä¢ üîî –í–∫–ª/–í—ã–∫–ª - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏\n" +
				"‚Ä¢ üìà –¢–∏–ø —Å–∏–≥–Ω–∞–ª–æ–≤ - –≤—ã–±–æ—Ä –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤\n" +
				"‚Ä¢ üîÑ –°–±—Ä–æ—Å–∏—Ç—å - —Å–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–æ–≤\n" +
				"‚Ä¢ ‚è±Ô∏è –ü–µ—Ä–∏–æ–¥—ã - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–∏–æ–¥–æ–≤ –∞–Ω–∞–ª–∏–∑–∞\n" +
				"‚Ä¢ üîô –ù–∞–∑–∞–¥ - –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"
			return mh.messageSender.SendMessageToChat(chatID, message, nil)
		}
		log.Printf("‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è %d: %v", userID, err)
	}

	// Fallback: –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
	periodName := "15 –º–∏–Ω—É—Ç"
	if mh.menuUtils != nil {
		period := getPeriodFromConfig(mh.config)
		periodName = mh.menuUtils.GetPeriodName(period)
	}

	message := "‚öôÔ∏è *–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞*\n\n" +
		"*–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:*\n" +
		"‚Ä¢ üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: " + getNotificationStatus(mh.config) + "\n" +
		"‚Ä¢ üìà –¢–∏–ø —Å–∏–≥–Ω–∞–ª–æ–≤: " + getSignalTypesStatus(mh.config) + "\n" +
		"‚Ä¢ ‚è±Ô∏è –ü–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∞: " + periodName + "\n\n" +
		"–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏–∑ –º–µ–Ω—é –Ω–∏–∂–µ:\n\n" +
		"‚Ä¢ üîî –í–∫–ª/–í—ã–∫–ª - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏\n" +
		"‚Ä¢ üìà –¢–∏–ø —Å–∏–≥–Ω–∞–ª–æ–≤ - –≤—ã–±–æ—Ä –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤\n" +
		"‚Ä¢ üîÑ –°–±—Ä–æ—Å–∏—Ç—å - —Å–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–æ–≤\n" +
		"‚Ä¢ ‚è±Ô∏è –ü–µ—Ä–∏–æ–¥—ã - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–∏–æ–¥–æ–≤ –∞–Ω–∞–ª–∏–∑–∞\n" +
		"‚Ä¢ üîô –ù–∞–∑–∞–¥ - –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"

	return mh.messageSender.SendMessageToChat(chatID, message, nil)
}

// SendNotificationsInfo –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö (–≤–µ—Ä—Å–∏—è —Å userID)
func (mh *MenuHandlers) SendNotificationsInfo(chatID string, userID int) error {
	// –ï—Å–ª–∏ –µ—Å—Ç—å —Å–µ—Ä–≤–∏—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ–ª—É—á–∞–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
	if mh.hasUserServices() && userID > 0 {
		settings, err := mh.settingsManager.GetUserSettingsTelegram(userID)
		if err == nil {
			message := "üîî *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏*\n\n" +
				settings + "\n\n" +
				"–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏–∑ –º–µ–Ω—é –Ω–∏–∂–µ:\n\n" +
				"‚Ä¢ ‚úÖ –í–∫–ª—é—á–∏—Ç—å - –≤–∫–ª—é—á–∏—Ç—å –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\n" +
				"‚Ä¢ ‚ùå –í—ã–∫–ª—é—á–∏—Ç—å - –≤—ã–∫–ª—é—á–∏—Ç—å –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\n" +
				"‚Ä¢ üìä –í—Å–µ —Å–∏–≥–Ω–∞–ª—ã - —É–≤–µ–¥–æ–º–ª—è—Ç—å –æ–±–æ –≤—Å–µ—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö\n" +
				"‚Ä¢ üìà –¢–æ–ª—å–∫–æ —Ä–æ—Å—Ç - —É–≤–µ–¥–æ–º–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –æ —Ä–æ—Å—Ç–µ\n" +
				"‚Ä¢ üìâ –¢–æ–ª—å–∫–æ –ø–∞–¥–µ–Ω–∏–µ - —É–≤–µ–¥–æ–º–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –æ –ø–∞–¥–µ–Ω–∏–∏\n" +
				"‚Ä¢ üîô –ù–∞–∑–∞–¥ - –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"
			return mh.messageSender.SendMessageToChat(chatID, message, nil)
		}
	}

	// Fallback: –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
	status := getNotificationStatus(mh.config)

	message := fmt.Sprintf("üîî *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏*\n\n"+
		"–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: %s\n\n"+
		"–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏–∑ –º–µ–Ω—é –Ω–∏–∂–µ:\n\n"+
		"‚Ä¢ ‚úÖ –í–∫–ª—é—á–∏—Ç—å - –≤–∫–ª—é—á–∏—Ç—å –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\n"+
		"‚Ä¢ ‚ùå –í—ã–∫–ª—é—á–∏—Ç—å - –≤—ã–∫–ª—é—á–∏—Ç—å –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\n"+
		"‚Ä¢ üìä –í—Å–µ —Å–∏–≥–Ω–∞–ª—ã - —É–≤–µ–¥–æ–º–ª—è—Ç—å –æ–±–æ –≤—Å–µ—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö\n"+
		"‚Ä¢ üìà –¢–æ–ª—å–∫–æ —Ä–æ—Å—Ç - —É–≤–µ–¥–æ–º–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –æ —Ä–æ—Å—Ç–µ\n"+
		"‚Ä¢ üìâ –¢–æ–ª—å–∫–æ –ø–∞–¥–µ–Ω–∏–µ - —É–≤–µ–¥–æ–º–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –æ –ø–∞–¥–µ–Ω–∏–∏\n"+
		"‚Ä¢ üîô –ù–∞–∑–∞–¥ - –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏",
		status)

	return mh.messageSender.SendMessageToChat(chatID, message, nil)
}

// SendSignalTypesInfo –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–∏–ø–∞—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ (–≤–µ—Ä—Å–∏—è —Å userID)
func (mh *MenuHandlers) SendSignalTypesInfo(chatID string, userID int) error {
	// –ï—Å–ª–∏ –µ—Å—Ç—å —Å–µ—Ä–≤–∏—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
	var growthStatus, fallStatus string
	if mh.hasUserServices() && userID > 0 {
		// TODO: –ü–æ–ª—É—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ë–î
		// –ü–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
		growthStatus = "‚ùå –í—ã–∫–ª—é—á–µ–Ω"
		if mh.config.TelegramNotifyGrowth {
			growthStatus = "‚úÖ –í–∫–ª—é—á–µ–Ω"
		}
		fallStatus = "‚ùå –í—ã–∫–ª—é—á–µ–Ω"
		if mh.config.TelegramNotifyFall {
			fallStatus = "‚úÖ –í–∫–ª—é—á–µ–Ω"
		}
	} else {
		// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
		growthStatus = "‚ùå –í—ã–∫–ª—é—á–µ–Ω"
		if mh.config.TelegramNotifyGrowth {
			growthStatus = "‚úÖ –í–∫–ª—é—á–µ–Ω"
		}
		fallStatus = "‚ùå –í—ã–∫–ª—é—á–µ–Ω"
		if mh.config.TelegramNotifyFall {
			fallStatus = "‚úÖ –í–∫–ª—é—á–µ–Ω"
		}
	}

	message := fmt.Sprintf("üìä *–¢–∏–ø—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤*\n\n"+
		"–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:\n"+
		"‚Ä¢ üìà –†–æ—Å—Ç: %s\n"+
		"‚Ä¢ üìâ –ü–∞–¥–µ–Ω–∏–µ: %s\n\n"+
		"–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏–∑ –º–µ–Ω—é –Ω–∏–∂–µ:\n\n"+
		"‚Ä¢ üìà –¢–æ–ª—å–∫–æ —Ä–æ—Å—Ç - –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ä–æ—Å—Ç\n"+
		"‚Ä¢ üìâ –¢–æ–ª—å–∫–æ –ø–∞–¥–µ–Ω–∏–µ - –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–∞–¥–µ–Ω–∏–µ\n"+
		"‚Ä¢ üìä –í—Å–µ —Å–∏–≥–Ω–∞–ª—ã - –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤—Å–µ —Å–∏–≥–Ω–∞–ª—ã\n"+
		"‚Ä¢ üîî –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏\n"+
		"‚Ä¢ üìä –°—Ç–∞—Ç—É—Å - –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã\n"+
		"‚Ä¢ üîô –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é - –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é",
		growthStatus, fallStatus)

	return mh.messageSender.SendMessageToChat(chatID, message, nil)
}

// SendPeriodsInfo –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–∏–æ–¥–∞—Ö (–≤–µ—Ä—Å–∏—è —Å userID)
func (mh *MenuHandlers) SendPeriodsInfo(chatID string, userID int) error {
	// –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–∏–æ–¥ –∏–∑ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
	period := getPeriodFromConfig(mh.config)
	periodName := mh.menuUtils.GetPeriodName(period)

	message := "‚è±Ô∏è *–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–∏–æ–¥–æ–≤ –∞–Ω–∞–ª–∏–∑–∞*\n\n" +
		"–¢–µ–∫—É—â–∏–π –ø–µ—Ä–∏–æ–¥: " + periodName + "\n\n" +
		"–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –∏–∑ –º–µ–Ω—é –Ω–∏–∂–µ:\n\n" +
		"‚Ä¢ ‚è±Ô∏è 5 –º–∏–Ω - 5 –º–∏–Ω—É—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥\n" +
		"‚Ä¢ ‚è±Ô∏è 15 –º–∏–Ω - 15 –º–∏–Ω—É—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥\n" +
		"‚Ä¢ ‚è±Ô∏è 30 –º–∏–Ω - 30 –º–∏–Ω—É—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥\n" +
		"‚Ä¢ ‚è±Ô∏è 1 —á–∞—Å - 1 —á–∞—Å–æ–≤–æ–π –ø–µ—Ä–∏–æ–¥\n" +
		"‚Ä¢ ‚è±Ô∏è 4 —á–∞—Å–∞ - 4 —á–∞—Å–æ–≤–æ–π –ø–µ—Ä–∏–æ–¥\n" +
		"‚Ä¢ üîô –ù–∞–∑–∞–¥ - –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"

	return mh.messageSender.SendMessageToChat(chatID, message, nil)
}

// SendResetInfo –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–±—Ä–æ—Å–µ (–≤–µ—Ä—Å–∏—è —Å userID)
func (mh *MenuHandlers) SendResetInfo(chatID string, userID int) error {
	// –ï—Å–ª–∏ –µ—Å—Ç—å —Å–µ—Ä–≤–∏—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º —Å–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫
	if mh.hasUserServices() && userID > 0 {
		message := "üîÑ *–°–±—Ä–æ—Å*\n\n" +
			"–í—ã–±–µ—Ä–∏—Ç–µ —á—Ç–æ —Å–±—Ä–æ—Å–∏—Ç—å:\n\n" +
			"‚Ä¢ üîÑ –í—Å–µ —Å—á–µ—Ç—á–∏–∫–∏ - —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ —Å—á–µ—Ç—á–∏–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤\n" +
			"‚Ä¢ üìä –ü–æ —Å–∏–º–≤–æ–ª—É - —Å–±—Ä–æ—Å–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ –¥–ª—è —Å–∏–º–≤–æ–ª–∞\n" +
			"‚Ä¢ ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - —Å–±—Ä–æ—Å–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏\n" +
			"‚Ä¢ ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ - –ø–µ—Ä–µ–π—Ç–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏\n" +
			"‚Ä¢ üîô –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é - –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"
		return mh.messageSender.SendMessageToChat(chatID, message, nil)
	}

	// –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
	message := "üîÑ *–°–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–æ–≤ —Å–∏–≥–Ω–∞–ª–æ–≤*\n\n" +
		"–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏–∑ –º–µ–Ω—é –Ω–∏–∂–µ:\n\n" +
		"‚Ä¢ üîÑ –í—Å–µ —Å—á–µ—Ç—á–∏–∫–∏ - —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ —Å—á–µ—Ç—á–∏–∫–∏\n" +
		"‚Ä¢ üìä –ü–æ —Å–∏–º–≤–æ–ª—É - —Å–±—Ä–æ—Å–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ –¥–ª—è —Å–∏–º–≤–æ–ª–∞\n" +
		"‚Ä¢ ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ - –ø–µ—Ä–µ–π—Ç–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏\n" +
		"‚Ä¢ üîô –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é - –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"

	return mh.messageSender.SendMessageToChat(chatID, message, nil)
}
